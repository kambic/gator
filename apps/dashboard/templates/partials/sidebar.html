{% load static i18n %}

<nav class="sb-sidenav accordion sb-sidenav-dark" id="sidenavAccordion" x-data="sidebar">
  <div class="sb-sidenav-menu">
    <div class="nav">

      <!-- Brand -->
      <div class="sb-sidenav-menu-heading">
        <a href="/" class="text-white text-decoration-none d-flex align-items-center">
          <i class="fas fa-alligator fa-lg me-2"></i>
          Alligator
        </a>
      </div>

      <!-- ========== Vidra Dropdown ========== -->
      <div>
        <a href="#"
           class="nav-link d-flex align-items-center justify-content-between"
           @click.prevent="toggle('vidra')"
           :class="{ 'collapsed': !isOpen('vidra') }">
          <div class="sb-nav-link-icon">
            <i class="fas fa-film"></i>
          </div>
          Vidra
          <div class="sb-sidenav-collapse-arrow">
            <i class="fas fa-angle-down transition-transform duration-200"
               :class="{ 'rotate-180': isOpen('vidra') }"></i>
          </div>
        </a>

        <div x-show="isOpen('vidra')"
             x-transition:enter="transition ease-out duration-200"
             x-transition:enter-start="opacity-0 scale-y-95"
             x-transition:enter-end="opacity-100 scale-y-100"
             x-transition:leave="transition ease-in duration-150"
             x-transition:leave-start="opacity-100 scale-y-100"
             x-transition:leave-end="opacity-0 scale-y-95"
             class="overflow-hidden"
             style="transform-origin: top;">
          <nav class="sb-sidenav-menu-nested nav py-1">

            <a class="nav-link" href="{% url 'dashboard:new_job_ui' %}">
              <i class="fas fa-plus text-info me-2"></i>
              Create
            </a>

            <a class="nav-link" href="{% url 'dashboard:tasks_list' %}">
              <i class="fas fa-list text-info me-2"></i>
              Create
            </a>

            <a class="nav-link" href="{% url 'dashboard:celery_dashboard' %}">
              <i class="fas fa-tasks text-info me-2"></i>
              Queue Status
            </a>
          </nav>
        </div>
      </div>

      <!-- ========== Ateme Dropdown ========== -->
      <div>
        <a href="#"
           class="nav-link d-flex align-items-center justify-content-between"
           @click.prevent="toggle('ateme')"
           :class="{ 'collapsed': !isOpen('ateme') }">
          <div class="sb-nav-link-icon">
            <i class="fas fa-file-video"></i>
          </div>
          Ateme
          <div class="sb-sidenav-collapse-arrow">
            <i class="fas fa-angle-down transition-transform duration-200"
               :class="{ 'rotate-180': isOpen('ateme') }"></i>
          </div>
        </a>

        <div x-show="isOpen('ateme')"
             x-transition:enter="transition ease-out duration-200"
             x-transition:enter-start="opacity-0 scale-y-95"
             x-transition:enter-end="opacity-100 scale-y-100"
             x-transition:leave="transition ease-in duration-150"
             x-transition:leave-start="opacity-100 scale-y-100"
             x-transition:leave-end="opacity-0 scale-y-95"
             class="overflow-hidden"
             style="transform-origin: top;">
          <nav class="sb-sidenav-menu-nested nav py-1">
            <a class="nav-link" href="#">
              <i class="fas fa-plus-circle text-warning me-2"></i>
              Create
            </a>
            <a class="nav-link" href="#">
              <i class="fas fa-eye text-info me-2"></i>
              Table
            </a>
          </nav>
        </div>
      </div>

      <!-- ========== Players Dropdown ========== -->
      <div>
        <a href="#"
           class="nav-link d-flex align-items-center justify-content-between"
           @click.prevent="toggle('players')"
           :class="{ 'collapsed': !isOpen('players') }">
          <div class="sb-nav-link-icon">
            <i class="fas fa-play-circle"></i>
          </div>
          Players
          <div class="sb-sidenav-collapse-arrow">
            <i class="fas fa-angle-down transition-transform duration-200"
               :class="{ 'rotate-180': isOpen('players') }"></i>
          </div>
        </a>

        <div x-show="isOpen('players')"
             x-transition:enter="transition ease-out duration-200"
             x-transition:enter-start="opacity-0 scale-y-95"
             x-transition:enter-end="opacity-100 scale-y-100"
             x-transition:leave="transition ease-in duration-150"
             x-transition:leave-start="opacity-100 scale-y-100"
             x-transition:leave-end="opacity-0 scale-y-95"
             class="overflow-hidden"
             style="transform-origin: top;">

{% comment %}
          <nav class="sb-sidenav-menu-nested nav py-1">

            <a class="nav-link" href="#">
              <i class="fas fa-eye text-info me-2"></i>
              Shaka
            </a>

            <a class="nav-link" href="#">
              <i class="fas fa-eye text-info me-2"></i>
              Dash
            </a>
          </nav>
          {% endcomment %}
        </div>
      </div>

      <!-- ========== Flower Link ========== -->
      <a class="nav-link" href="/flower/">
        <div class="sb-nav-link-icon">
          <i class="fas fa-leaf"></i>
        </div>
        Flower
      </a>

      <!-- Divider -->
      <div class="sb-sidenav-menu-heading"></div>

      <!-- ========== Superuser-only Links ========== -->
      {% if request.user.is_superuser %}
        <a class="nav-link" href="http://bpl-vidra-03.ts.telekom.si:8080/rabbitmq/">
          <div class="sb-nav-link-icon">
            <i class="fas fa-cogs"></i>
          </div>
          RabbitMQ
        </a>
        <a class="nav-link" href="{% url 'admin:index' %}">
          <div class="sb-nav-link-icon">
            <i class="fas fa-user-shield"></i>
          </div>
          Admin
        </a>
        <a class="nav-link" href="/supervisor/">
          <div class="sb-nav-link-icon">
            <i class="fas fa-eye"></i>
          </div>
          Supervisor
        </a>
      {% endif %}
    </div>
  </div>

  <!-- Sidebar Footer -->
  <div class="sb-sidenav-footer">
    {% if request.user.is_authenticated %}
      <div class="small">Logged in as:</div>
      <div class="d-flex align-items-center">
        <strong>{{ request.user.username }}</strong>
      </div>
      <form method="post" action="{% url 'admin:logout' %}" class="mt-2">
        {% csrf_token %}
        <button type="submit" class="btn btn-sm btn-outline-light w-100">Logout</button>
      </form>
    {% else %}
      <a href="{% url 'admin:login' %}" class="btn btn-warning btn-sm w-100">Login</a>
    {% endif %}
  </div>
</nav>
