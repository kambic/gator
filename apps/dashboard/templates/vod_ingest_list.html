{% extends "layout.html" %}
{% load static %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
  <div class="container mt-5">
    <h1>{{ title }}</h1>
    <p class="lead">Scanning path: <code>{{ scan_path }}</code></p>
    <hr>

    {# Display Django Messages (Success/Error Feedback) #}
    {% if messages %}
      <ul class="list-unstyled">
        {% for message in messages %}
          <li class="alert alert-{{ message.tags }}">
            {{ message }}
          </li>
        {% endfor %}
      </ul>
    {% endif %}

    {% if file_list %}
      <table class="table table-striped table-hover">
        <thead class="thead-dark">
        <tr>
          <th>File Name</th>
          <th>Size (MB)</th>
          <th>Last Modified</th>
          <th>Action</th>
        </tr>
        </thead>
        <tbody>
        {% for file in file_list %}
          <tr>
            <td>{{ file.name }}</td>
            <td>{{ file.size|floatformat:0 }}</td>
            <td>{{ file.modified|date:"Y-m-d H:i:s" }}</td>
            <td>
              <form method="post" action="#" style="display:inline;">
                {% csrf_token %}
                <input type="hidden" name="file_path" value="{{ file.path }}">
                <button type="submit" class="btn btn-sm btn-primary">
                  Start Ingest
                </button>
              </form>
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    {% else %}
      <div class="alert alert-info">
        No ZIP files found in the specified directory.
      </div>
    {% endif %}
  </div>
{% endblock %}
